control substitution on

statement ok
SET exon.bam_parse_tags = true;

statement ok
CREATE EXTERNAL TABLE cram STORED AS CRAM OPTIONS (fasta_reference '/Users/thauck/wheretrue/github.com/wheretrue/exon/exon-benchmarks/data/HG00096.alt_bwamem_GRCh38DH.20150718.GBR.low_coverage.cram') LOCATION '$CARGO_MANIFEST_DIR/test-data/datasources/cram/test_input_1_a.cram';

query I
SELECT name, flag, reference, start, end, mapping_quality, cigar, mate_reference, tags."PG" FROM cram LIMIT 1;
----
r000 99 insert 50 59 30 10M insert bull

statement ok
DROP TABLE cram;

statement ok
SET exon.bam_parse_tags = false;

statement ok
CREATE EXTERNAL TABLE cram STORED AS CRAM OPTIONS (fasta_reference '/Users/thauck/wheretrue/github.com/wheretrue/exon/exon-benchmarks/data/HG00096.alt_bwamem_GRCh38DH.20150718.GBR.low_coverage.cram') LOCATION '$CARGO_MANIFEST_DIR/test-data/datasources/cram/test_input_1_a.cram';

query I
SELECT name, flag, reference, start, end, mapping_quality, cigar, mate_reference, tags FROM cram LIMIT 1;
----
r000 99 insert 50 59 30 10M insert [{tag: PG, value: bull}]

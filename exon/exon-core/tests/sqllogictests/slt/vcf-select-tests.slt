control substitution on

statement ok
CREATE EXTERNAL TABLE vcf_table STORED AS VCF LOCATION '$CARGO_MANIFEST_DIR/test-data/datasources/vcf/index.vcf';

statement ok
SET exon.vcf_parse_info = true

statement ok
SET exon.vcf_parse_formats = true

query T
SELECT length(info) FROM vcf_table LIMIT 5;
----
0
0
0
0
0

query I
SELECT formats FROM vcf_table LIMIT 5;
----
PL  0,3,26
PL  0,3,34
PL  0,3,33
PL  0,3,34
PL  0,3,35

statement ok
DROP TABLE vcf_table;

statement ok
CREATE EXTERNAL TABLE vcf_table STORED AS VCF COMPRESSION TYPE GZIP PARTITIONED BY (sample) LOCATION '$CARGO_MANIFEST_DIR/test-data/datasources/vcf-partition/';

query T
SELECT sample, chrom FROM vcf_table WHERE sample = '2' LIMIT 1;
----
2 1

query T
SELECT sample, COUNT(chrom) FROM vcf_table WHERE sample = '2' GROUP BY sample ORDER BY sample;
----
2  621

statement ok
DROP TABLE vcf_table;
